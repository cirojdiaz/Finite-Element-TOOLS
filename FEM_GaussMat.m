%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%  PONTOS E PESSOS DE GAUSS ORDEM 6 NUM RE-  %%
%%   -TANGULO TAMANHO [X1,X2]x[Y1,Y2]         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

function [px,py,wx,wy,ppx,ppy,wwx,wwy] = FEM_GaussMat(x1,x2,y1,y2,Ng)


dx = (x2-x1)/2;    dy = (y2-y1)/2;                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
ax = (x2-x1)/2;    bx = (x2+x1)/2;                %% Calculando os parametros da transformação %%%
ay = (y2-y1)/2;    by = (y2+y1)/2;                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

TX = @(x) ax*x + bx;   TY = @(y) ay*y + by;       %  Calcula la transformación de [-1,1] ---> [x1,y1]
if Ng == 4
    a = 0.3399810435848562648026658;       k = 0.6521451548625461426269361;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    b = 0.8611363115940525752239465;       r = 0.3478548451374538573730639;           %%%%   Valores para calcular os pontos e pesos GL4   %%%%%%%

    p = [-b,-a,a,b];                       w = [r,k,k,r];                             % Pontos e pessos de Gauss ordem 6 no intervalo [-1,1] 
elseif Ng == 6
    a = 0.2386191860831969086305017;       k = 0.4679139345726910473898703;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    b = 0.6612093864662645136613996;       r = 0.3607615730481386075698335;           %%%%   Valores para calcular os pontos e pesos GL6   %%%%%%%
    c = 0.9324695142031520278123016;       s = 0.1713244923791703450402961;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    p = [-c,-b,-a,a,b,c];                  w = [s,r,k,k,r,s];                         % Pontos e pessos de Gauss ordem 6 no intervalo [-1,1] 
elseif Ng == 8
    a = 0.1834346424956498049394761;       k = 0.3626837833783619829651504;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    b = 0.5255324099163289858177390;       r = 0.3137066458778872873379622;           %%%%   Valores para calcular os pontos e pesos GL8  %%%%%%%
    c = 0.7966664774136267395915539;       s = 0.2223810344533744705443560;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    d = 0.9602898564975362316835609;       t = 0.1012285362903762591525314;

    p = [-d,-c,-b,-a,a,b,c,d];             w = [t,s,r,k,k,r,s,t];                     % Pontos e pessos de Gauss ordem 6 no intervalo [-1,1]
elseif Ng == 10
    a = 0.1488743389816312108848260;       k = 0.2955242247147528701738930;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    b = 0.4333953941292471907992659;       r = 0.2692667193099963550912269;           %%%%   Valores para calcular os pontos e pesos GL 10  %%%%%%%
    c = 0.6794095682990244062343274;       s = 0.2190863625159820439955349;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    d = 0.8650633666889845107320967;       t = 0.1494513491505805931457763;
    e = 0.9739065285171717200779640;       u = 0.0666713443086881375935688;
    p = [-e,-d,-c,-b,-a,a,b,c,d,e];        w = [u,t,s,r,k,k,r,s,t,u];                 % Pontos e pessos de Gauss ordem 6 no intervalo [-1,1]    
elseif Ng == 12
    a = 0.1252334085114689154724414;       k = 0.2491470458134027850005624;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    b = 0.3678314989981801937526915;       r = 0.2334925365383548087608499;           %%%%   Valores para calcular os pontos e pesos GL 10  %%%%%%%
    c = 0.5873179542866174472967024;       s = 0.2031674267230659217490645;           %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    d = 0.7699026741943046870368938;       t = 0.1600783285433462263346525;
    e = 0.9041172563704748566784659;       u = 0.1069393259953184309602547;
    f = 0.9815606342467192506905491;       v = 0.0471753363865118271946160;
    p = [-f,-e,-d,-c,-b,-a,a,b,c,d,e,f];   w = [v,u,t,s,r,k,k,r,s,t,u,v];                 % Pontos e pessos de Gauss ordem 6 no intervalo [-1,1]       
end  
                                                  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%            
ppy = TY(p);            wwy = dy*w;               %%% Pontos e pesos de Gauss no rectangulinho %%%
ppx = TX(p);            wwx = dx*w;               %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%       
                                    
[px,py] = meshgrid(ppx,ppy);                      %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%           
[wx,wy] = meshgrid(wwx,wwy);                      %%% Malha de pontos e pessos de Gauss ordem 6 %%
                                                  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                                                                              
end